<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Каталоги напитков — Dynamic</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>

  <style>
    :root{
      --poster-height: 30rem;
      --poster-max-width: 360px;
    }

    body{
      margin:0;
      padding:0;
      font-family: Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;
      background: url("https://res.cloudinary.com/glide/image/fetch/f_auto,w_675,c_limit/https://storage.googleapis.com/glide-prod.appspot.com/uploads-v2/TAPjb2GQS3bpIi2Qh1vu/pub/YHvEGQ7gKxwfedZm9Io8.png")
                  repeat-y center top fixed;
      background-size: 100% auto;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      color:#111;
    }

    main{ max-width:1200px; margin:0 auto; padding:0 16px; }
    .top-spacer{ height: var(--poster-height); width:100%; pointer-events:none; }
    h1{ text-align:center; margin:28px 0 0; font-size:32px; font-weight:700; }

    .catalog-grid{
      display:grid;
      grid-template-columns:1fr;
      gap:1.25rem;
      justify-items:center;
      margin: 1.25rem auto;
    }
    @media(min-width:640px){
      .catalog-grid{ grid-template-columns: repeat(2, minmax(320px,1fr)); }
    }
    .catalog-grid > .only-last{ grid-column: 1 / -1; justify-self:center; }

    .catalog-card{
      width:100%;
      max-width: var(--poster-max-width);
      height: var(--poster-height);
      border-radius: 12px;
      overflow:hidden;
      position:relative;
      box-shadow: 0 14px 40px rgba(2,6,23,0.12);
      transition: transform .28s ease, box-shadow .28s ease;
      cursor:pointer;
      background:#fff;
    }
    .catalog-card:hover{
      transform: translateY(-6px);
      box-shadow:0 22px 48px rgba(2,6,23,0.18);
    }
    .catalog-card img{
      width:100%; height:100%;
      object-fit:cover; display:block;
      transition:transform .32s ease, filter .32s ease;
    }
    .catalog-card:hover img{
      transform:scale(1.03);
      filter:brightness(.86);
    }

    .catalog-footer{
      position:absolute; left:0; right:0; bottom:0;
      padding:12px; background: rgba(255,255,255,0.36);
      backdrop-filter: blur(14px) saturate(115%);
      -webkit-backdrop-filter: blur(14px) saturate(115%);
      transition: background .28s ease, backdrop-filter .28s ease;
    }
    .catalog-card:hover .catalog-footer{
      background: rgba(255,255,255,0.64);
      backdrop-filter: blur(22px) saturate(140%);
      -webkit-backdrop-filter: blur(22px) saturate(140%);
    }

    #overlay{
      position:fixed; inset:0; background:rgba(0,0,0,0.36); z-index:40; display:none;
    }
    #overlay.active{ display:block; }

    #sheet{
      position:fixed; left:0; right:0; bottom:0; z-index:50;
      transform: translateY(100%);
      transition: transform .36s cubic-bezier(.2,.9,.2,1);
      border-top-left-radius:18px; border-top-right-radius:18px;
      max-height:90vh; overflow:hidden; pointer-events:auto;
    }
    #sheet.visible{ transform: translateY(0%); }

    .sheet-inner{
      height:100%;
      display:flex; flex-direction:column;
      background: rgba(255,255,255,0.48);
      backdrop-filter: blur(20px) saturate(120%);
      -webkit-backdrop-filter: blur(20px) saturate(120%);
      padding:12px 14px 14px;
    }

    .drinks-row{
      display:flex; gap:12px; overflow-x:auto; padding:8px 10px 22px;
      scroll-snap-type:x mandatory; -webkit-overflow-scrolling:touch; align-items:flex-end;
    }
    .drinks-row::-webkit-scrollbar{ display:none; }

    .drink-card{
      position:relative;
      flex:0 0 20rem; width:20rem; height:30rem;
      border-radius:14px; overflow:hidden;
      box-shadow:0 12px 32px rgba(2,6,23,0.12);
      scroll-snap-align:center;
      transition:transform .28s ease, box-shadow .28s ease;
      background:transparent;
    }
    .drink-card img{
      width:100%; height:100%; object-fit:cover; display:block;
      transition: transform .36s ease, filter .36s ease;
    }
    .drink-card:hover{ transform: translateY(-6px); box-shadow:0 18px 44px rgba(2,6,23,0.18); }
    .drink-card:hover img{ transform: scale(1.04); filter: brightness(.92); }

    .drink-info{
      position:absolute; left:0; right:0; bottom:0;
      padding:12px; height:6.4rem; overflow:hidden;
      background: rgba(255,255,255,0.30);
      backdrop-filter: blur(14px) saturate(120%);
      -webkit-backdrop-filter: blur(14px) saturate(120%);
      transition: height .28s ease, background .28s ease, padding .28s ease;
    }
    .drink-info .more{
      opacity:0; transform: translateY(6px);
      transition: opacity .28s ease, transform .28s ease;
      font-size:13px; color:#444;
    }
    .drink-card:hover .drink-info,
    .drink-card.expanded .drink-info{
      height:11.6rem; padding:14px;
      background: rgba(255,255,255,0.56);
    }
    .drink-card:hover .drink-info .more,
    .drink-card.expanded .drink-info .more{
      opacity:1; transform: translateY(0);
    }

    .btn-round{
      height:44px; width:44px; display:flex;
      align-items:center; justify-content:center;
      border-radius:999px;
      background:rgba(255,255,255,0.46);
      backdrop-filter:blur(10px);
      border:1px solid rgba(255,255,255,0.38);
    }

    .hidden{ display:none; }
  </style>
</head>

<body>
  <main>
    <h1>Каталоги напитков</h1>
    <div class="top-spacer" aria-hidden="true"></div>
    <div id="catalogGrid" class="catalog-grid" aria-live="polite"></div>
  </main>

  <div id="overlay" aria-hidden="true"></div>
  <div id="sheet" aria-hidden="true">
    <div class="sheet-inner" style="height:86vh;">
      <div style="width:48px;height:6px;background:rgba(100,100,100,0.18);border-radius:999px;margin:8px auto 12px"></div>
      <div style="display:flex;align-items:center;justify-content:space-between;padding:0 8px 8px">
        <h2 id="catalogTitle" style="font-size:20px;margin:0"></h2>
        <button id="closeBtn" aria-label="Close" style="background:transparent;border:none;font-size:22px;cursor:pointer">✕</button>
      </div>
      <div style="position:relative;padding:8px 10px 12px;flex:1;display:flex;align-items:flex-end">
        <button id="prevBtn" class="btn-round hidden md:inline-flex" style="position:absolute;left:8px;top:50%;transform:translateY(-50%);z-index:10">‹</button>
        <div id="catalogItems" class="drinks-row" aria-live="polite"></div>
        <button id="nextBtn" class="btn-round hidden md:inline-flex" style="position:absolute;right:8px;top:50%;transform:translateY(-50%);z-index:10">›</button>
      </div>
    </div>
  </div>

  <script>
    const overlay = document.getElementById('overlay');
    const sheet = document.getElementById('sheet');
    const catalogGrid = document.getElementById('catalogGrid');
    const catalogItems = document.getElementById('catalogItems');
    const catalogTitle = document.getElementById('catalogTitle');
    const prevBtn = document.getElementById('prevBtn');
    const nextBtn = document.getElementById('nextBtn');
    const closeBtn = document.getElementById('closeBtn');

    // Загружаем CSV
    Papa.parse("catalog.csv", {
      download: true,
      header: true,
      complete: (results) => {
        const data = results.data.filter(r => r.catalog && r.name);
        renderCatalogs(data);
      }
    });

    function renderCatalogs(data) {
      const catalogs = [...new Set(data.map(d => d.catalog))];
      catalogs.forEach((cat, index) => {
        const sample = data.find(d => d.catalog === cat && d.image);
        const img = sample ? sample.image : "https://placehold.co/600x900?text="+encodeURIComponent(cat);
        const card = document.createElement('div');
        card.className = 'catalog-card';
        card.dataset.catalog = cat;
        card.innerHTML = `
          <img src="${img}" alt="${cat}">
          <div class="catalog-footer">
            <h3 style="margin:0;font-size:20px;font-weight:700">${cat}</h3>
            <p style="margin:6px 0 0;color:#444">Каталог с уникальными напитками</p>
          </div>`;
        card.addEventListener('click', () => openCatalog(cat, data));
        catalogGrid.appendChild(card);
      });
    }

    function openCatalog(cat, data) {
      const drinks = data.filter(d => d.catalog === cat);
      catalogTitle.textContent = cat;
      catalogItems.innerHTML = '';

      drinks.forEach((d, idx) => {
        const card = document.createElement('div');
        card.className = 'drink-card';
        card.innerHTML = `
          <img src="${d.image}" alt="${d.name}">
          <div class="drink-info">
            <div style="display:flex;justify-content:space-between;align-items:center">
              <h3 style="margin:0;font-size:16px;font-weight:700">${d.name}</h3>
              <strong style="font-size:13px">${d.price ? d.price + " ₽" : ""}</strong>
            </div>
            <p style="margin:8px 0 0;color:#444;font-size:13px">${d.about || ""}</p>
          </div>`;
        catalogItems.appendChild(card);
      });

      overlay.classList.add('active');
      sheet.classList.add('visible');
      sheet.setAttribute('aria-hidden','false');
      if (window.innerWidth >= 768){
        prevBtn.classList.remove('hidden'); nextBtn.classList.remove('hidden');
      } else {
        prevBtn.classList.add('hidden'); nextBtn.classList.add('hidden');
      }
    }

    function closeCatalog(){
      sheet.classList.remove('visible');
      overlay.classList.remove('active');
      sheet.setAttribute('aria-hidden','true');
      setTimeout(()=> catalogItems.innerHTML = '', 320);
    }

    overlay.addEventListener('click', closeCatalog);
    closeBtn.addEventListener('click', closeCatalog);
  </script>
</body>
</html>
